# Webシステムの構築と運用
## 01. 提供するサービスの検討

Webシステムを構築する時は、最初にそこで提供するサービスの検討を行う。
全体の概要から初めて最終的にアプリケーションの詳細な昨日まで落とし込み、システムん基盤に求める機能を洗い出す。
具体的には、「__サービスの内容__」「__アプリケーションに必要な機能・デザイン__」「__システム基盤に必要な機能__」を順に検討していく。

**サービスの内容**
サービスの内容について検討し、具体化していく。

**アプリケーションに必要な機能・デザイン**
サービスに必要となる機能を検討する。
また、利用者やアクセスする端末によって必要となってくる表示方法を検討する。

**システム基盤に求められる機能**
アプリケーションに必要な機能が決まった後のシステム基盤に求められる機能が決まってくる。
サービスに用いる機器などの検討を行う。

## 02. 利用言語、ソフトウェアの検討

提供するサービスの内容が決まったら、それを開発するためのプログラミング言語や動作させるために利用するソフトウェアを選定する。

## 03. ネットワーク構成の検討

Webシステムの用途や要求されるセキュリティレベル、投入できるコストなどによって最適な後世は異なってくるため、まずはそういった要素からネットワークの構成を検討することから始める。

**ネットワークの分割**
外部ネットワーク : インターネットに晒される
内部ネットワーク : インターネットと隔離された
DMZ(DeMilitarized Zone) : 外部ネットワークと内部ネットワークの境界に位置し、両者からのアクセスを受けつつ、不正な通信を防ぐため内部ネットワークへの通信は最低限とする。

インターネットからの接続があるシステムにおいて、攻撃を防ぐためにはファイアーウォールが必須

## 04. サーバー構成の検討

ネットワーク構成が決まれば、各ネットワークに配置するサーバーの構成の検討に入る。
各サーバーの役割を考慮し、どのサーバーききで動作させるのか、サーバー機器の配置先のネットワークをどこにするのか、サーバーの冗長化を行うかどうかを中心に構成を検討する。

**ロードバランサー**
Webサーバーを冗長化する際、システムに届くリクエストをどのWebサーバーに渡すかということを考える必要が出てくる。この振り分け作業を行うための機器がロードバランサー。

## 05. サーバー基盤の検討

自分で機器を購入するか、誰かから借りるか

**オンプレミス**
「自社運用」を指す言葉
自分で機器を購入して利用する方法。

**レンタルサーバー**
貸し出しているサーバーを間借りして、そこにWebアプリケーションを配置する.

**クラウド**
他社が提供する仮想的なサーバーを設置できる環境の中にサーバーを設置して利用する方法

## 06. 負荷分散

サーバーを複数台並列に設置し、リクエストを振り分けて並列で実行させることで各サーバーの負荷を軽減する方法。

負荷分散はロードバランサーが行う

**ラウンドロビン方式**
各サーバーに順番にリクエストを振り返る方式。
各リクエストの処理の複雑さが同程度で、かつ各サーバーの処理能力が同じである場合に有効。

**動的分散方式**
サーバーの負荷を監視し、負荷が少ないサーバーに優先してリクエストを振り分ける方式。

**パーシステンス**
同一クライアントからのアクセスを判別し、常に同じサーバーへ転送する機能

## 07. サーバー設計・構築

WebサーバーやAPサーバーなど、システムないで割り振られた役割を実行するだけでなく、ここのサーバーとして耐障害性やセキュリティを考慮した設計となっている必要がある。

- ディスク構成
- セキュリティ
- システム基盤テスト

**パーティショニング**
ディスクが複数確保できない場合は１つのディスクを内部で分割する方法

## 08. データベース設計

論理設計と物理設計の２段階に分けられる

**論理設計**
データベースに格納すべきデータの洗い出しとそのデータ同士の関連性を定義する。

**物理設計**
論理設計で定義されたデータを実際のデータベースないでどのように格納するかをきめる。

**インデックス**
頻繁に検索されるデータにはデータベース索引を生成するようにしておくと検索速度が向上する。

## 09. アプリケーション設計

提供するサービスの内容から基本設計、詳細設計を行い、その設計内容をもとにプログラミングを行う

**基本設計**
提供したいサービスを実現するためにアプリケーションがどういった動作をするのかを設計する。
具体的には、アプリケーションの持つ機能の一覧やアプリケーションの構成図、画面レイアウトなどを検討する。
そのため、基本設計は外部設計とも呼ばれる。

**詳細設計**
基本設計の内容を実現するためには具体的にどのようなモジュールを作成すれば良いかを検討し、設計するのが詳細設計。
具体的には、モジュールの処理内容、モジュール間の連携方法、画面フローを検討する。
アプリケーション内部構造の設計となるため、詳細設計は内部設計とも呼ばれる。

**単体テスト**
詳細設計通りにモジュールが作られているかを確認するため、モジュールごとにテストを実施する。

**連結テスト**
モジュール同士がうまく連携し、基本設計通りに動くかを確認するテスト

## 10. バックアップ運用

バックアップデータの取得や不要となった古いデータの削除などの作業を __バックアップ運用__ と呼ぶ。

## 11. ログ運用

**ログファイル**
サーバーやネットワーク機器は動作状態の変化や自分の行った処理を的すtファイルに記録している。

**システムログ**
OSが発生したイベントやエラーを記録

**アプリケーションログ**
ミドルウェアなどのアプリケーションの動作を記録する

**アクセスログ**
Webサーバーなどが受けたリクエストを記録する。

ログファイルはどんどん追記されていくため、メンテナンスを行わなければならない

**ログローテーション**
ログファイルを切り分け、別のファイルとして保存することでログの可読性を確保する。
ハウスキープとも呼ばれる。

**アクセス解析ログ**
アクセスログを解析して参考となる情報を得ること

Webサーバーのアクセスログにはユーザーのアクセスしてきた日時やどのページにアクセスしてきていたかといった情報が記録されるため、有効に使えばサービスの向上や売上増加につなげられる。

アクセス解析ようのソフトも開発されている。

## 12. Webサイトのパフォーマンス

**パフォーマンス**
リクエストが送られてからユーザーに対して画面が表示されるまでの時間など
ユーザーが利用する際の満足度の１つとされる

**応答時間**
リクエスト送信からHTTPの応答が返ってくるまでの時間

**表示完了時間**
リクエスト送信からWebページが表示されるまでの時間

**ページ読み込み時間**
ページの読み込み開始から読み込み完了までの時間

**可用性**
エラーなくWebサイトにアクセスできた確率

webシステム構築の際、ユーザーの満足度を満たすためには予めこのパフォーマンスの目標値を決め、それを満たすことを目指すことが大切

## 13. 脆弱性診断

**ペネトレーションテスト**
擬似的に攻撃を行うことで脆弱性の有無を確認するテスト